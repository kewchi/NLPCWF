# -*- coding: utf-8 -*-
"""NLPCWF_app.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1jEhqaVaEV2fv3Lg06URTjWMQq-IpAg9y
"""

# Commented out IPython magic to ensure Python compatibility.

import streamlit as st
from transformers import pipeline, AutoTokenizer, AutoModelForQuestionAnswering

def load_model():
    # Load DistilBERT model and tokenizer
    tokenizer = AutoTokenizer.from_pretrained("distilbert-base-cased-distilled-squad")
    model = AutoModelForQuestionAnswering.from_pretrained("distilbert-base-cased-distilled-squad", return_dict=True)

    # Question answering pipeline
    qa_pipe = pipeline("question-answering", model=model, tokenizer=tokenizer)
    return qa_pipe

qa_pipe = load_model()

# Streamlit app
def main():
    st.title("Red Panda Q&A")

    # User input
    context = "The red panda is slightly larger than a domestic cat with a bear-like body and thick russet fur. The belly and limbs are black, and there are white markings on the side of the head and above its small eyes. Red pandas are very skillful and acrobatic animals that predominantly stay in trees. Almost 50% of the red panda’s habitat is in the Eastern Himalayas. They use their long, bushy tails for balance and to cover themselves in winter, presumably for warmth. Primarily an herbivore, the name panda is said to come from the Nepali word ‘ponya,’ which means bamboo or plant eating animal."
    question = st.text_area("Question", value="What is the answer to...")

    # Answer button
    if st.button("Get Answer"):
        # If input is not empty
        if question.strip() != "" and context.strip() != "":
            
            # Get the answer using the pipeline
            answer = qa_pipe(question=question, context=context)

            # Display the answer
            st.markdown(f"Answer: {answer['answer']}")
            st.info(f"Confidence: {answer['score']}")

if __name__ == "__main__":
    main()


